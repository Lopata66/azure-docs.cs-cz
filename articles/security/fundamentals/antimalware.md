---
title: Microsoft Antimalware pro Azure | Microsoft Docs
description: Tento článek obsahuje přehled architektury Microsoft Antimalware pro Azure, včetně podporovaných scénářů a konfigurací pro povolení, konfiguraci a nasazení ochrany pro Azure Cloud Services a Virtual Machines. Základní funkce pro konfiguraci, správu a monitorování, které jsou přístupné prostřednictvím rozhraní API pro správu služeb Microsoft Azure, PowerShellu, Azure Portal a sady Visual Studio.
services: security
documentationcenter: na
author: barclayn
manager: barbkess
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/26/2019
ms.author: barclayn
ms.openlocfilehash: 2b0a8ff9160f5f311bbe3f74afcd4ff8eddf62f4
ms.sourcegitcommit: 7b25c9981b52c385af77feb022825c1be6ff55bf
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/13/2020
ms.locfileid: "79282585"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Microsoft Antimalware pro Azure Cloud Services a Virtual Machines

Microsoft Antimalware pro Azure je bezplatná ochrana v reálném čase, která pomáhá identifikovat a odstraňovat viry, spyware a další škodlivý software. Vygeneruje výstrahy v případě, že se známý škodlivý nebo nežádoucí software pokusí nainstalovat nebo spustit v systémech Azure.

Řešení je postavené na stejné antimalwarové platformě jako Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune a Windows Defender. Microsoft Antimalware pro Azure je jedním z agentů pro aplikace a klientská prostředí navržená tak, aby běžela na pozadí bez zásahu člověka. Ochranu můžete nasadit v závislosti na potřebách úloh aplikací, a to buď základní zabezpečená, nebo Pokročilá vlastní konfigurace, včetně antimalwarového monitorování.

Když nasadíte a povolíte Microsoft Antimalware pro Azure pro vaše aplikace, jsou k dispozici následující základní funkce:

* **Ochrana v reálném čase** – monitoruje aktivitu v Cloud Services a na Virtual Machines ke zjišťování a blokování spouštění malwaru.
* **Naplánované prohledávání** – pravidelně kontrolují malware, včetně aktivně spouštěných programů.
* **Náprava malwaru** – automaticky provede akci zjištěného malwaru, jako je odstranění nebo karanténa škodlivých souborů a vyčištění škodlivých položek registru.
* **Aktualizace signatur** – automaticky nainstaluje nejnovější signatury ochrany (definice virů), aby se zajistila aktuálnost ochrany s předem určenou frekvencí.
* **Aktualizace antimalwarového stroje** – automaticky aktualizuje modul Microsoft Antimalware.
* **Aktualizace antimalwarové platformy** – automaticky aktualizuje platformu Microsoft Antimalware.
* **Aktivní ochrana** – hlásí metadata telemetrie o zjištěných hrozbách a podezřelých zdrojích, aby se Microsoft Azure zajistila rychlá odezva na vývojovou a v reálném čase prostřednictvím systému Microsoft Active Protection System (Maps).
* **Vytváření sestav ukázek** – poskytuje a sestavuje ukázky služby Microsoft antimalwar Service, které vám pomůžou službu zdokonalit a povolit řešení potíží.
* **Vyloučení** – umožňuje správcům aplikací a služeb konfigurovat vyloučení pro soubory, procesy a jednotky.  
* **Shromažďování antimalwarových událostí** – zaznamenává stav antimalwarové služby, podezřelé aktivity a nápravné akce provedené v protokolu událostí operačního systému a shromažďuje je do účtu Azure Storage zákazníka.

> [!NOTE]
> Microsoft Antimalware se dá nasadit taky pomocí Azure Security Center. Další informace najdete v tématu věnovaném [instalaci Endpoint Protection v Azure Security Center](../../security-center/security-center-install-endpoint-protection.md) .

## <a name="architecture"></a>Architektura

Microsoft Antimalware pro Azure zahrnuje Microsoft Antimalwarový klient a službu, Antimalwarový model nasazení, rutiny antimalwarového PowerShellu a rozšíření Azure Diagnostics. Microsoft Antimalware je podporován v systémech Windows Server 2008 R2, Windows Server 2012 a Windows Server 2012 R2 řady operačních systémů. Tato podpora není podporována v operačním systému Windows Server 2008 a také není podporována v systému Linux.

Microsoft Antimalwarový klient a služba se ve výchozím nastavení nainstalují v zakázaném stavu ve všech podporovaných rodinách hostovaných operačních systémech Azure na platformě Cloud Services. Microsoft Antimalware Client and Service není ve výchozím nastavení nainstalován v Virtual Machines platformě a je k dispozici jako volitelná funkce prostřednictvím Azure Portal a konfigurace virtuálního počítače sady Visual Studio v části rozšíření zabezpečení.

Při použití Azure App Service má podkladová služba, která je hostitelem webové aplikace, povolená aplikace Microsoft Antimalware. Slouží k ochraně Azure App Service infrastruktury a neběží na zákaznickém obsahu.

> [!NOTE]
> Windows Defender je integrovaný Antimalwarový program, který je ve Windows serveru 2016 povolený. Rozhraní Windows Defender je ve výchozím nastavení povolené i v některých SKU Windows serveru 2016. [Další informace najdete tady](https://docs.microsoft.com/windows/threat-protection/windows-defender-antivirus/windows-defender-antivirus-on-windows-server-2016). Do virtuálního počítače s Windows serverem 2016 Azure můžete i nadále přidat antimalwarové rozšíření Azure VM, ale v tomto scénáři bude rozšíření používat jakékoli volitelné [zásady konfigurace](https://gallery.technet.microsoft.com/Antimalware-For-Azure-5ce70efe) , které budou používat Windows Defender, a rozšíření nebude nasazovat žádné další antimalwarové služby.
> Další informace o této aktualizaci si můžete přečíst [tady](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).

### <a name="microsoft-antimalware-workflow"></a>Pracovní postup Microsoft antimalwaru

Správce služby Azure může povolit antimalwar pro Azure s výchozí nebo vlastní konfigurací pro váš Virtual Machines a Cloud Services pomocí následujících možností:

* Virtual Machines – v Azure Portal v části **rozšíření zabezpečení**
* Virtual Machines – použití konfigurace virtuálních počítačů sady Visual Studio v Průzkumník serveru
* Virtual Machines a Cloud Services – s využitím [modelu nasazení pro klasický vývoj](https://msdn.microsoft.com/library/azure/ee460799.aspx) softwaru
* Virtual Machines a Cloud Services – používání rutin prostředí PowerShell pro antimalware

Rutiny Azure Portal nebo PowerShellu nahrajte soubor balíčku antimalwarové rozšíření do systému Azure do předem stanoveného pevného umístění. Agent hosta Azure (nebo agent infrastruktury) spustí antimalwarové rozšíření a použije nastavení antimalwarové konfigurace dodané jako vstup. Tento krok umožňuje, aby antimalwarová služba měla buď výchozí, nebo vlastní nastavení konfigurace. Pokud není k dispozici žádná vlastní konfigurace, je antimalwarová služba povolená s výchozími nastaveními konfigurace. Další podrobnosti najdete v části *antimalwarová konfigurace* v tématu [Microsoft Antimalware pro Azure – ukázky kódu](https://aka.ms/amazsamples "Ukázky kódu Microsoft antimalwaru pro Azure Cloud Services a virtuálních počítačů") .

Po spuštění Microsoft antimalwarového klienta stáhne nejnovější ochranu a definice podpisů z Internetu a načte je do systému Azure. Služba Microsoft Antimalware zapisuje události související se službou do protokolu událostí operačního systému v rámci zdroje událostí "Microsoft Antimalware". Události zahrnují stav antimalwarového klienta, stav ochrany a nápravy, nové a staré konfigurační nastavení, aktualizace modulu a definice signatur a další.

Monitorování antimalwaru pro cloudovou službu nebo virtuální počítač můžete povolit, aby se události protokolu antimalwarové události napsaly při jejich vytvoření na účet úložiště Azure. Antimalwarová služba používá rozšíření Azure Diagnostics ke shromažďování antimalwarových událostí ze systému Azure do tabulek v účtu Azure Storage zákazníka.

Pracovní postup nasazení, včetně kroků konfigurace a možností podporovaných ve výše uvedených scénářích, najdete v části [scénáře nasazení antimalwaru](#antimalware-deployment-scenarios) v tomto dokumentu.

![Microsoft Antimalware v Azure](./media/antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> K nasazení Virtual Machine Scale Sets pomocí rozšíření Microsoft Anti-Malware můžete ale použít PowerShell/rozhraní API a šablony Azure Resource Manager.  Pro instalaci rozšíření na již běžícím virtuálním počítači můžete použít vzorový skript Python [vmssextn.py](https://github.com/gbowerman/vmsstools). Tento skript získá existující konfiguraci rozšíření v sadě škálování a přidá rozšíření do seznamu existujících rozšíření na VM Scale Sets.
>
>

### <a name="default-and-custom-antimalware-configuration"></a>Výchozí a vlastní antimalwarová konfigurace

Výchozí nastavení konfigurace se aplikují na Povolit antimalwar pro Azure Cloud Services nebo Virtual Machines, když neposkytnete vlastní nastavení konfigurace. Výchozí nastavení konfigurace je předem optimalizované pro běh v prostředí Azure. Volitelně můžete upravit tato výchozí nastavení konfigurace podle požadavků pro nasazení aplikace nebo služby Azure a použít je pro jiné scénáře nasazení.

Následující tabulka shrnuje nastavení konfigurace, která jsou k dispozici pro antimalwarovou službu. Výchozí nastavení konfigurace jsou označená pod sloupcem s označením výchozí.

![Tabulka 1](./media/antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>Scénáře nasazení antimalwaru

V této části jsou popsány scénáře povolení a konfigurace antimalwaru, včetně monitorování pro Azure Cloud Services a Virtual Machines.

### <a name="virtual-machines---enable-and-configure-antimalware"></a>Virtuální počítače – povolení a konfigurace antimalwaru

#### <a name="deployment-while-creating-a-vm-using-the-azure-portal"></a>Nasazení při vytváření virtuálního počítače pomocí Azure Portal

Pokud chcete povolit a nakonfigurovat Microsoft Antimalware pro Azure Virtual Machines pomocí Azure Portal při zřizování virtuálního počítače, postupujte podle následujících kroků:

1. Přihlaste se k webu Azure Portal na adrese <https://portal.azure.com>.
2. Pokud chcete vytvořit nový virtuální počítač, přejděte na **virtuální počítače**, vyberte **Přidat**a zvolte **Windows Server**.
3. Vyberte verzi systému Windows Server, kterou chcete použít.
4. Vyberte **Vytvořit**.
    ![vytvořit virtuální počítač](./media/antimalware/create-vm.PNG)
5. Zadejte **jméno**, **uživatelské jméno**, **heslo**a vytvořte novou skupinu prostředků nebo vyberte existující skupinu prostředků.
6. Vyberte **OK**.
7. Vyberte velikost virtuálního počítače.
8. V další části proveďte příslušné volby podle svých potřeb. Vyberte oddíl **rozšíření** .
9. Vyberte **Přidat rozšíření** .
10. V části **nový prostředek**vyberte **Microsoft Antimalware**.
11. Vyberte **Vytvořit**.
12. V souboru oddílu **instalovat rozšíření** můžete nakonfigurovat umístění a vyloučení procesů a také další možnosti kontroly. Vyberte **OK**.
13. Vyberte **OK**.
14. Zpátky v části **Nastavení** klikněte na **OK**.
15. Na obrazovce **vytvořit** klikněte na **tlačítko OK**.

#### <a name="deployment-using-the-visual-studio-virtual-machine-configuration"></a>Nasazení pomocí konfigurace virtuálního počítače s Visual Studiem

Povolení a konfigurace antimalwarové služby Microsoftu pomocí sady Visual Studio:

1. Připojení k Microsoft Azure v aplikaci Visual Studio.

2. Vyberte virtuální počítač v uzlu **Virtual Machines** v **Průzkumník serveru**

   ![Konfigurace virtuálního počítače v aplikaci Visual Studio](./media/antimalware/sec-azantimal-fig5.PNG)

3. Kliknutím pravým tlačítkem na **Konfigurovat** zobrazíte stránku konfigurace virtuálního počítače.

4. V rozevíracím seznamu v části **nainstalovaná rozšíření** vyberte **Microsoft antimalwar** Extension a klikněte na **Přidat** , aby se nakonfigurovali výchozí antimalwarová konfigurace.
    ![nainstalovaných rozšíření](./media/antimalware/sec-azantimal-fig6.PNG)
5. Pokud chcete nastavit výchozí antimalwarovou konfiguraci, vyberte v seznamu nainstalovaných rozšíření antimalwarové rozšíření a klikněte na **Konfigurovat**.

6. V textovém poli **veřejné konfigurace** nahraďte výchozí antimalwarovou konfiguraci vlastní konfigurací v podporovaném formátu JSON a klikněte na OK.

7. Kliknutím na tlačítko **aktualizovat** nahrajte aktualizace konfigurace do svého virtuálního počítače.

    ![Rozšíření konfigurace virtuálního počítače](./media/antimalware/sec-azantimal-fig7.PNG)

> [!NOTE]
>Konfigurace sady Visual Studio Virtual Machines pro antimalware podporuje pouze konfiguraci formátu JSON. Šablona nastavení konfigurace pro Antimalwarový formát JSON je obsažená v [ukázkách kódu Microsoft Antimalware pro Azure](https://aka.ms/amazsamples "Microsoft Antimalware pro Azure – ukázky kódu")a zobrazuje podporovaná nastavení antimalwarových konfigurací.

#### <a name="deployment-using-powershell-cmdlets"></a>Nasazení pomocí rutin prostředí PowerShell

Aplikace nebo služba Azure může povolit a nakonfigurovat Microsoft Antimalware pro Azure Virtual Machines pomocí rutin PowerShellu.

Povolení a konfigurace antimalwarového programu Microsoft Antimalware pomocí rutin antimalwarového prostředí PowerShell:

1. Nastavení prostředí PowerShell – Přečtěte si dokumentaci na adrese <https://github.com/Azure/azure-powershell>
2. K povolení a konfiguraci antimalwarového programu Microsoftu pro váš virtuální počítač použijte [rutinu Set-AzureVMMicrosoftAntimalwareExtension antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) .

> [!NOTE]
>Konfigurace Azure Virtual Machines pro antimalware podporuje jenom konfiguraci formátu JSON. Šablona nastavení konfigurace pro Antimalwarový formát JSON je obsažená v [ukázkách kódu Microsoft Antimalware pro Azure](https://aka.ms/amazsamples "Microsoft Antimalware pro Azure – ukázky kódu")a zobrazuje podporovaná nastavení antimalwarových konfigurací.

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Povolení a konfigurace antimalwaru pomocí rutin PowerShellu

Aplikace nebo služba Azure může povolit a nakonfigurovat Microsoft Antimalware pro Azure Cloud Services pomocí rutin PowerShellu. Upozorňujeme, že Microsoft Antimalware je nainstalovaný v zakázaném stavu na platformě Cloud Services a vyžaduje akci, kterou aplikace Azure povolí.

Povolení a konfigurace antimalwarového programu Microsoft Antimalware pomocí rutin PowerShellu:

1. Nastavení prostředí PowerShell – Přečtěte si dokumentaci na adrese <https://github.com/Azure/azure-powershell>
2. Pomocí [rutiny Set-AzureServiceAntimalwareExtension antimalwaru](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) můžete povolit a nakonfigurovat Microsoft Antimalware pro cloudovou službu.

Šablona nastavení konfigurace antimalwarového kódu XML je součástí antimalwarového programu [Microsoftu pro Azure-Code Samples](https://aka.ms/amazsamples "Microsoft Antimalware pro Azure – ukázky kódu"), který zobrazuje podporované nastavení antimalwarové konfigurace.

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Cloud Services a Virtual Machines-konfigurace pomocí rutin prostředí PowerShell

Aplikace nebo služba Azure může získat konfiguraci Microsoft antimalwaru pro Cloud Services a Virtual Machines pomocí rutin PowerShellu.

Načtení konfigurace Microsoft antimalwaru pomocí rutin PowerShellu:

1. Nastavení prostředí PowerShell – Přečtěte si dokumentaci na adrese <https://github.com/Azure/azure-powershell>
2. **Virtual Machines**: k získání antimalwarové konfigurace použijte [rutinu Get-AzureVMMicrosoftAntimalwareExtension antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azurevmmicrosoftantimalwareextension) .
3. **Cloud Services**: k získání antimalwarové konfigurace použijte [rutinu Get-AzureServiceAntimalwareConfig antimalware](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureserviceantimalwareconfig) .

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Odebrání antimalwarové konfigurace pomocí rutin prostředí PowerShell

Aplikace nebo služba Azure může odebrat antimalwarovou konfiguraci a veškerá přidruženou konfiguraci antimalwarového monitorování od příslušných rozšíření služby Azure antimalware a diagnostiky, která jsou přidružená ke cloudové službě nebo virtuálnímu počítači.

Postup odebrání antimalwaru Microsoftu pomocí rutin PowerShellu:

1. Nastavení prostředí PowerShell – Přečtěte si dokumentaci na adrese <https://github.com/Azure/azure-powershell>
2. **Virtual Machines**: použijte [antimalwarovou rutinu Remove-AzureVMMicrosoftAntimalwareExtension](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azurevmmicrosoftantimalwareextension).
3. **Pro Cloud Services:** Použijte [antimalwarovou rutinu Remove-AzureServiceAntimalwareExtension](https://docs.microsoft.com/powershell/module/servicemanagement/azure/remove-azureserviceantimalwareextension).

**Povolení** shromažďování antimalwarových událostí pro virtuální počítač pomocí portálu Azure Preview:

1. V okně virtuálního počítače klikněte na jakoukoli část kontrolního skla.
2. Klikněte na příkaz Diagnostika v okně metrika.
3. Vyberte **stav** zapnuto a zaškrtněte možnost systém událostí systému Windows.
4. . Můžete vybrat možnost zrušit kontrolu všech ostatních možností v seznamu nebo je nechat zapnutá podle potřeb vaší aplikační služby.
5. Kategorie antimalwarových událostí "Error", "Warning", "informativní" atd.) jsou zachyceny ve vašem účtu Azure Storage.

Antimalwarové události se shromažďují z protokolů systému událostí Windows do účtu Azure Storage. Výběrem příslušného účtu úložiště můžete nakonfigurovat účet úložiště pro váš virtuální počítač a shromažďovat antimalwarové události.

![Metriky a diagnostika](./media/antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> Další informace o tom, jak diagnostikovat protokolování pro Azure antimalware, najdete v článku [Povolení protokolování diagnostiky pro Azure antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Povolení a konfigurace antimalwarového monitorování pomocí rutin prostředí powerShell

Můžete povolit shromažďování antimalwarových událostí Microsoftu pro cloudovou službu nebo virtuální počítač pomocí Azure Diagnostics prostřednictvím rutin prostředí PowerShell pro antimalwarové služby. Rozšíření Azure Diagnostics se dá nakonfigurovat tak, aby se do vašeho účtu Azure Storage zachytí události ze zdroje protokolu systémových událostí "Microsoft Antimalware". Kategorie antimalwarových událostí "Error", "Warning", "informativní" atd.) jsou zachyceny ve vašem účtu Azure Storage.

Povolení shromažďování antimalwarových událostí pro váš Azure Storage účet pomocí rutin PowerShellu:

1. Nastavení prostředí PowerShell – Přečtěte si <https://github.com/Azure/azure-powershell>
2. **Pro Virtual Machines** – použijte [antimalwarovou rutinu Set-AzureVMMicrosoftAntimalwareExtension](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azurevmmicrosoftantimalwareextension) s možností monitorování zapnuto.
3. **Pro Cloud Services** – použijte [antimalwarovou rutinu Set-AzureServiceAntimalwareExtension](https://docs.microsoft.com/powershell/module/servicemanagement/azure/set-azureserviceantimalwareextension) s možností monitorování zapnuto.

Antimalwarové nezpracované události si můžete prohlédnout v tabulce *WADWindowsEventLogsTable* v účtu Azure Storage, který jste nakonfigurovali pro povolení antimalwarového monitorování. To může být užitečné při ověřování, jestli shromažďování antimalwarových událostí funguje, včetně získání přehledu o stavu antimalwarové služby. Další informace, včetně ukázkového kódu pro extrakci antimalwarových událostí z účtu úložiště, najdete v tématu [Microsoft Antimalware pro Azure – ukázky kódu](https://aka.ms/amazsamples "Microsoft Antimalware pro Azure – ukázky kódu").
