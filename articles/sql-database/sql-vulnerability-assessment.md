---
title: Posouzení ohrožení zabezpečení SQL
description: Zjistěte, jak nakonfigurovat posouzení ohrožení zabezpečení SQL v Azure SQL Database a interpretovat sestavy hodnocení.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 02/05/2020
tags: azure-synapse
ms.openlocfilehash: a54cbb017e85ec10e142ffae8981bc839aac37f4
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/28/2020
ms.locfileid: "80061669"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Posouzení ohrožení zabezpečení SQL pomáhá identifikovat chyby zabezpečení databáze

Sql Assessment je snadno konfigurovatelná služba, která dokáže zjistit, sledovat a pomoci vám napravit potenciální chyby zabezpečení databáze. Můžete ji aktivně využít ke zlepšení zabezpečení vaší databáze.

Posouzení ohrožení zabezpečení je součástí nabídky [Advanced Data Security,](sql-database-advanced-data-security.md) což je jednotný balíček pro pokročilé možnosti zabezpečení SQL. K posouzení ohrožení zabezpečení lze přistupovat a spravovat jej prostřednictvím centrálního portálu SQL Advanced Data Security.

> [!NOTE]
> Posouzení ohrožení zabezpečení je podporované pro Azure SQL Database, Azure SQL Database spravované instance a Azure Synapse Analytics. Pro jednoduchost SQL Database se používá v tomto článku při odkazování na některou z těchto služeb spravované databáze.

## <a name="vulnerability-assessment"></a>Posouzení ohrožení zabezpečení

Sql Posouzení ohrožení zabezpečení je služba, která poskytuje přehled o stavu zabezpečení. Posouzení ohrožení zabezpečení zahrnuje užitečné kroky k řešení problémů se zabezpečením a zvýšení zabezpečení databáze. To vám může pomoci: 

- Splňte požadavky na dodržování předpisů, které vyžadují sestavy prohledávačdatabáze.
- Splňte standardy ochrany osobních údajů.
- Sledujte prostředí dynamické databáze, kde je obtížné sledovat změny.

Posouzení ohrožení zabezpečení je skenovací služba integrovaná do azure sql database. Služba využívá znalostní bázi pravidel, která označují chyby zabezpečení. Upozorňuje na odchylky od osvědčených postupů, jako jsou chybné konfigurace, nadměrná oprávnění a nechráněná citlivá data.

Pravidla jsou založena na osvědčených postupech společnosti Microsoft a zaměřují se na problémy se zabezpečením, které představují největší rizika pro vaši databázi a její cenná data. Zahrnují problémy na úrovni databáze a problémy se zabezpečením na úrovni serveru, jako je nastavení brány firewall serveru a oprávnění na úrovni serveru. Tato pravidla také představují mnoho požadavků různých regulačních orgánů na splnění jejich norem pro dodržování předpisů.

Výsledky prohledávky zahrnují užitečné kroky k vyřešení každého problému a případně poskytnout přizpůsobené nápravné skripty. Zprávu o hodnocení pro prostředí můžete přizpůsobit nastavením přijatelného směrného plánu pro:
* Konfigurace oprávnění.
* Konfigurace funkcí.
* Nastavení databáze.

## <a name="implement-vulnerability-assessment"></a>Implementace posouzení ohrožení zabezpečení

Následující kroky implementují posouzení ohrožení zabezpečení v databázi SQL.

### <a name="1-run-a-scan"></a>1. Spusťte skenování

V podokně Databáze Azure SQL vyberte v záhlaví **Zabezpečení** **rozšířené zabezpečení dat**. Potom klepnutím na tlačítko **Vybrat úložiště** v podokně Posouzení **chyb zabezpečení** otevřete podokno Nastavení posouzení ohrožení zabezpečení pro celý server SQL.

Nakonfigurujte účet úložiště, ve kterém budou uloženy výsledky skenování pro všechny databáze na serveru. Informace o účtech úložiště najdete [v tématu O účtech úložiště Azure](../storage/common/storage-create-storage-account.md). Po nakonfigurování úložiště vyberte **prohledat,** chcete-li prohledat chyby zabezpečení v databázi.

![Skenování databáze](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Skenování je lehké a bezpečné. Spuštění trvá několik sekund a je zcela jen pro čtení. Neprovede žádné změny v databázi.

### <a name="2-view-the-report"></a>2. Zobrazit sestavu

Po dokončení skenování se sestava skenování automaticky zobrazí na webu Azure Portal. Sestava představuje přehled stavu zabezpečení. Uvádí, kolik problémů bylo nalezeno a jejich závažnosti. Výsledky zahrnují upozornění na odchylky od osvědčených postupů a snímek nastavení souvisejících se zabezpečením, jako jsou objekty databáze a role a jejich přidružená oprávnění. Sestava skenování také poskytuje mapu citlivých dat zjištěných v databázi. Obsahuje doporučení ke klasifikaci dat pomocí [zjišťování dat a klasifikace](sql-database-data-discovery-and-classification.md).

![Zobrazení sestavy](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Analyzujte výsledky a vyřešte problémy

Zkontrolujte výsledky a určete zjištění v sestavě, která jsou skutečnými problémy se zabezpečením ve vašem prostředí. Přejděte k jednotlivým neúspěšným výsledkům, abyste pochopili dopad nálezu a proč se každá kontrola zabezpečení nezdařila. K vyřešení problému použijte informace o nápravě, které sestava poskytuje.

![Analýza sestavy](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Nastavení směrného plánu

Při kontrole výsledků hodnocení můžete označit konkrétní výsledky jako přijatelný *směrný plán* ve vašem prostředí. Směrný plán je v podstatě přizpůsobení způsobu vykazovány výsledky. Výsledky, které odpovídají směrnému plánu, jsou považovány za předávání v následných prohledávacích. Po navázání stavu zabezpečení podle směrného plánu bude posouzení ohrožení zabezpečení hlásit pouze odchylky od směrného plánu. Tímto způsobem můžete zaměřit svou pozornost na příslušné otázky.

![Nastavení směrného plánu](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Spuštění nového skenování zobrazíte vlastní přehled sledování

Po dokončení nastavení **směrného plánu**pravidlo , spusťte novou prohledávku pro zobrazení vlastní sestavy. Posouzení ohrožení zabezpečení nyní hlásí pouze problémy se zabezpečením, které se odchylují od schváleného výchozího stavu.

![Zobrazení přizpůsobené sestavy](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Posouzení ohrožení zabezpečení lze nyní použít ke sledování, že databáze udržuje vysokou úroveň zabezpečení po celou dobu a že jsou splněny zásady organizace. Pokud jsou požadovány zprávy o dodržování předpisů, mohou být zprávy o posouzení zranitelnosti užitečné pro usnadnění procesu dodržování předpisů.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Nastavení pravidelných opakovaných skenů

Přejděte do nastavení posouzení ohrožení zabezpečení a zapněte **periodické opakované prohledávaní**. Toto nastavení konfiguruje posouzení ohrožení zabezpečení tak, aby automaticky spouštěla prohledávač databáze jednou týdně. Souhrn výsledků skenování je odeslán na e-mailové adresy, které zadáte.

![Zobrazení přizpůsobené sestavy](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Export hodnotící zprávy

Vyberte **Exportovat výsledky skenování,** chcete-li vytvořit zprávu aplikace Excel ke stažení o výsledku kontroly. Tato sestava obsahuje souhrnnou kartu, která zobrazuje souhrn hodnocení. Sestava obsahuje všechny neúspěšné kontroly. Obsahuje také kartu **Výsledky,** která obsahuje úplnou sadu výsledků z prohledávky. Výsledky zahrnují všechny kontroly, které byly spuštěny a podrobnosti o výsledku pro každý.

### <a name="8-view-scan-history"></a>8. Zobrazit historii skenování

Chcete-li zobrazit historii všech prohledávání, která byla v této databázi dříve spuštěna, vyberte možnost **Historie prohledávání** v podokně Posouzení ohrožení zabezpečení. Vyberte konkrétní prohledávku v seznamu a zobrazte podrobné výsledky tohoto skenování.

Posouzení ohrožení zabezpečení lze nyní použít ke sledování, že databáze udržuje vysokou úroveň zabezpečení po celou dobu a že jsou splněny zásady organizace. Pokud jsou požadovány zprávy o dodržování předpisů, mohou být zprávy o posouzení zranitelnosti užitečné pro usnadnění procesu dodržování předpisů.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Správa hodnocení ohrožení zabezpečení pomocí Azure PowerShellu

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Modul PowerShell Azure Resource Manager je stále podporovaný službou Azure SQL Database, ale veškerý budoucí vývoj je pro modul Az.Sql. Tyto rutiny naleznete v tématu [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Argumenty pro příkazy v modulu Az a v modulech AzureRm jsou v podstatě identické.

Rutiny prostředí Azure PowerShell můžete použít k programové správě hodnocení ohrožení zabezpečení. Podporované rutiny jsou:

- [Update-AzSqlDatabaseAssessmentSettingSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting)

  Aktualizuje nastavení posouzení ohrožení zabezpečení databáze.
- [Get-AzSqlDatabaseAssessmentSettingSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting)

  Vrátí nastavení posouzení ohrožení zabezpečení databáze.
- [Nastavení přehledu Clear-AzSqlDatabaseVulnerabilityAssessmentSettingSettingSettingSetting Clear-AzSqlDatabaseSettingSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting)

  Vymaže nastavení posouzení ohrožení zabezpečení databáze.
- [Set-AzSqlDatabaseAssessmentAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Nastaví směrný plán pravidla pro posouzení ohrožení zabezpečení.
- [Get-AzSqlDatabaseAssessmentAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Získá směrný plán pravidla pro posouzení ohrožení zabezpečení pro dané pravidlo.
- [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline)

  Vymaže směrný plán pravidla pro posouzení ohrožení zabezpečení. Nejprve nastavte účaří před použitím této rutiny k jeho vymazání.
- [Soubor SCan s hodnocením chyby zabezpečení databáze Start-AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan)

  Spustí spuštění prohledávače posouzení ohrožení zabezpečení.
- [Get-AzSqlDatabaseAssessmentAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord)

   Získá všechny záznamy prohledávače posouzení ohrožení zabezpečení přidružené k dané databázi.
- [Převést azsqldatabaseassessmentscan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan)

  Převede výsledky prohledávače posouzení ohrožení zabezpečení na soubor aplikace Excel.

Příklad skriptu najdete v [tématu podpora prostředí PowerShell pro hodnocení zranitelnosti Azure SQL](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Správa směrných plánů posouzení ohrožení zabezpečení pomocí šablon Správce prostředků

Chcete-li nakonfigurovat směrné plány posouzení ohrožení `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` zabezpečení pomocí šablon Azure Resource Manager, použijte typ.

Před přidáním `vulnerabilityAssessments` směrných plánů se ujistěte, že jste povolili v počítači se systémem SQL Server.

Tady je příklad pro definování směrného pravidla VA2065 pro masterdb a VA1143 do userdb jako prostředků v šabloně Správce prostředků:

```json
    "resources": [
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                                "FirewallRuleName3",
                                "StartIpAddress",
                                "EndIpAddress"
                                  ]
                    },{
                         "result": [
                                "FirewallRuleName4",
                                "62.92.15.68",
                                "62.92.15.68"
                            ]
                        
                    }
                ]
            },
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
            ],
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                            "dbo"
                        ]
                    }
                ]
            }
        }
    ]
}   
```

Pro hlavní databázi a databázi uživatelů jsou názvy prostředků definovány odlišně:

* Hlavní databáze - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>master</b>')]",
* Uživatelská databáze - "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/<b>default</b>')]",
 
 
 Chcete-li zpracovat logické typy jako true/false, nastavte výsledek směrného plánu s binárním vstupem, jako je "1"/"0".
 
 ```json
        {
            "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
            "apiVersion": "2018-06-01-preview",
            "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
            ],
            "properties": {
                "baselineResults": [
                    {
                        "result": [
                            "1"
                        ]
                    }
                ]
            }
        }
    ]
}   
```
 
 
## <a name="next-steps"></a>Další kroky  

- Další informace o [rozšířeném zabezpečení dat](sql-database-advanced-data-security.md).
- Přečtěte si další informace o [zjišťování a klasifikaci dat](sql-database-data-discovery-and-classification.md).
