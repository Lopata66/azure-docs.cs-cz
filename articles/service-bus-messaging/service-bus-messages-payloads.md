---
title: Azure Service Bus zprávy, datové části a serializace | Dokumentace Microsoftu
description: Přehled datových částí zprávy služby Service Bus
services: service-bus-messaging
documentationcenter: ''
author: clemensv
manager: timlt
editor: ''
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2018
ms.author: spelluru
ms.openlocfilehash: 636b48f409c1a86f7da87c38b6250610026d4547
ms.sourcegitcommit: d1aef670b97061507dc1343450211a2042b01641
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/27/2018
ms.locfileid: "47392597"
---
# <a name="messages-payloads-and-serialization"></a>Zprávy, datové části a serializace

Microsoft Azure Service Bus zpracovává zprávy. Zprávy vázané datovou část, jakož i metadata ve formě dvojice klíč hodnota vlastnosti, popisující datové části a poskytuje pokyny k Service Bus a aplikacím. V některých případech je dostačující k přenosu informací, která chce odesílatel komunikovat příjemcům těchto metadat samostatně a zůstávají prázdné i datové části.

Objektový model oficiální klienti služby Service Bus pro .NET a Javu odrážet abstraktní strukturu zprávy služby Service Bus, která se mapuje na a z přenosu protokolů, které podporuje služby Service Bus.
 
Zprávy služby Service Bus se skládá z část binární datové části, která služby Service Bus zpracovává nikdy v jakékoli formuláře na straně služby a dvě sady vlastností. *Zprostředkovatel vlastnosti* jsou předdefinovány v systému. Tyto předdefinované vlastnosti buď ovládat funkce na úrovni zpráv uvnitř zprostředkovatele nebo jsou mapovány na běžné a standardizované metadat položky. *Vlastnosti uživatele* jsou kolekce párů klíč hodnota, které můžete definovány a nastavení aplikací.
 
V následující tabulce jsou uvedeny vlastnosti pro předdefinované zprostředkovatele. Názvy jsou použity s všichni klienti se oficiální rozhraní API a taky [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Properties_) objekt JSON mapování protokolu HTTP.
 
Ekvivalentní názvů používaných na úrovni protokolu AMQP jsou uvedeny v závorkách. 

| Název vlastnosti                         | Popis                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (content-type)           | Volitelně popisuje datovou část zprávy s popisovačem ve formátu RFC2045, část 5; například `application/json`.                                                                                                                                                                                                                                                                                             |
|  [ID korelace](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (id korelace)       | Umožňuje aplikaci určit kontext zprávy pro účely korelace; například odráží **MessageId** zprávy, která je přidání reakce.                                                                                                                                                                                                                                                                  |
| [DeadLetterSource](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Nastavte pouze ve zprávách, které byly dead lettered a následně automaticky předána z fronty nedoručených zpráv s jinou entitou. Označuje entitu, ve kterém byla zpráva dead lettered. Tato vlastnost je jen pro čtení.                                                                                                                                                                                                                                  |
| [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Počet doručení, které se pokusil pro tuto zprávu. Hodnota tohoto čítače se zvýší, když vyprší platnost zámku zprávy nebo zprávy je explicitně opuštěny příjemce. Tato vlastnost je jen pro čtení.                                                                                                                                                                                                                                                  |
| [EnqueuedSequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | Pro zprávy, které byly předány automaticky tato vlastnost odpovídá pořadové číslo, které měly byla přiřazena první zprávu na jeho původní bod odeslání. Tato vlastnost je jen pro čtení.                                                                                                                                                                                                                                                                |
| [EnqueuedTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | Čas UTC rychlé kdy byla zpráva přijata a uložených v dané entitě. Tato hodnota může sloužit jako indikátor čas doručení autoritativní a neutrální, když příjemce, aby důvěřovala odesílatele hodiny. Tato vlastnost je jen pro čtení.                                                                                                                                                                                                   |
|  [ExpiresAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (absolutní čas vypršení platnosti) | Čas UTC rychlé ve kterém je zpráva označené k odstranění a již není k dispozici pro načtení z entity z důvodu vypršení její platnosti. Vypršení platnosti je řízen **TimeToLive** vlastnost a tato vlastnost je vypočítán z EnqueuedTimeUtc + TimeToLive. Tato vlastnost je jen pro čtení.                                                                                                                                                                           |
| [ForcePersistence](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Pro front nebo témat, které mají [EnableExpress](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) příznak nastaven, tuto vlastnost lze nastavit k označení, že zpráva musí nastavit jako trvalý, na disk předtím, než je potvrzen. Toto je standardní chování pro všechny entity ne express.                                                                                                                                                                                                         |
| [Popisek](/dotnet/api/microsoft.azure.servicebus.message.label) (předmět)                       | Tato vlastnost umožňuje aplikaci určují účel příjemci standardizované způsobem, podobně jako řádek předmětu e-mailové zprávy.                                                                                                                                                                                                                                                                                  |
| [LockedUntilUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | Pro zprávy přijaté v rámci zámek (režim předem nevyrovnaná přijímat neboli peek-lock) Tato vlastnost odpovídá uzamčen rychlé UTC, do kterého se nachází zprávy ve frontě nebo odběru. Když vyprší platnost zámku, [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) se zvýší, a zpráva opět k dispozici. Tato vlastnost je jen pro čtení.                                                                                                                         |
| [LockToken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | Token uzamčení se odkaz na zámek uložená zprostředkovatele v *neboli peek-lock* přijímat režimu. Token, který je možné připnout trvale až Zámek [odložení](message-deferral.md) rozhraní API a s ním, přijmout zprávu mimo pravidelných doručování tok stavu. Tato vlastnost je jen pro čtení.                                                                                                                                                               |
| [ID zprávy](/dotnet/api/microsoft.azure.servicebus.message.messageid) (id zprávy)                | Identifikátor zprávy je hodnota definované aplikací, které jednoznačně identifikuje zprávu a její datové části. Identifikátor je řetězec volného tvaru a můžou odrážet identifikátor GUID nebo identifikátor odvozené z kontextu aplikace. Pokud je povoleno, [vyhledávání duplicit](duplicate-detection.md) funkce identifikuje a odstraňuje druhé a další podání zprávy se stejnou **MessageId**.                                                                |
| [partitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | Pro [segmentované entity](service-bus-partitioning.md), tuto hodnotu nastavíte přiřazení související zprávy do stejného oddílu interní, umožňuje, aby správně zaznamenán pořadí pořadí odeslání. Oddíl je zvolena podle funkce hash přes tuto hodnotu a nemůže být vybrána přímo. S ohledem na relace entit **SessionId** vlastnost potlačuje tuto hodnotu.                                                                                                       |
| [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) (Komu)                    | Tato hodnota volitelné a definovaného aplikací je standardní způsob, jak vyjádřit Odpověď cestu k příjemce zprávy. Pokud odesílatel očekává, že odpověď, nastaví absolutní nebo relativní cestu z fronty nebo tématu očekává odpověď k odeslání do hodnotu.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (odpovědi – skupina id)  | Tato hodnota argumentech **ReplyTo** informace a určuje, které **SessionId** musí nastavit pro odpověď při odesílání odpovědi entity.                                                                                                                                                                                                                                                                            |
| [ScheduledEnqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Pro zprávy, které jsou pouze dostupné pro načtení po prodlevě definuje tato vlastnost rychlé UTC, kdy zprávy budou logicky zařazených do fronty, sekvencování a proto k dispozici pro načtení.                                                                                                                                                                                                                 |
| [sequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | Pořadové číslo je jedinečné celé 64-bit přiřazená zpráva přijata a ukládaná zprostředkovatele a funkce jako identifikátoru hodnotu true. Pro dělené entity nejvyšší 16 bitů, aby odrážely identifikátor oddílu. Pořadová čísla monotónně zvětšují a bez mezer. Se přejít na 0 vyčerpání 48-64 bit rozsahu. Tato vlastnost je jen pro čtení.                                                                |
| [ID relace](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (id skupiny)                  | S ohledem na relace entit tato hodnota definovaného aplikací určuje umístění relace zprávy. Zprávy se stejným identifikátorem relace jsou v souladu s souhrnu uzamčení a povolit přesně v daném pořadí zpracování a demultiplexování. Pro entity, které nejsou s ohledem na relaci tato hodnota se ignoruje.                                                                                                                                     |
| [Velikost](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | Odráží uložené velikost zprávy v protokolu broker jako počet bajtů, jak se započítává kvóty úložiště. Tato vlastnost je jen pro čtení.                                                                                                                                                                                                                                                                                                       |
| [Stav](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Označuje stav zprávy v protokolu. Tato vlastnost je relevantní pouze během zpráva procházení ("náhled"), k určení, zda je zpráva "aktivní" a k dispozici, protože dosáhne na začátek fronty, ať už je odloženo, nebo čeká na naplánovat. Tato vlastnost je jen pro čtení.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Tato hodnota je relativní doby trvání, po jejímž uplynutí vyprší platnost zprávy, počínaje pro rychlé zprávy byl přijat a ukládaná broker, protože zachycené v **EnqueueTimeUtc**. Pokud není nastavený explicitně, se předpokládá, že hodnota **DefaultTimeToLive** pro příslušné fronty nebo tématu. Úroveň zprávy **TimeToLive** hodnota nemůže být delší než entity **DefaultTimeToLive** nastavení. Pokud je delší, je tiše upraveno. |
| [K](/dotnet/api/microsoft.azure.servicebus.message.to) (do)                               | Tato vlastnost je vyhrazená pro budoucí použití v scénáře a ignoruje aktuálně zprostředkovatelem samotný. Aplikace můžete použít tuto hodnotu v řetězení scénářů řízených daty pravidlo auto-forward k označení požadovaného logické cíle zprávy.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Pokud je odeslána zpráva přes fronty přenosu v oboru transakce, tato hodnota vybere oddíl fronty přenosu.                                                                                                                                                                                                                                                                                                                 |

Model abstraktní zpráv umožňuje zprávu, která se mají publikovat do fronty přes protokol HTTP (ve skutečnosti vždy HTTPS) a je možné načíst prostřednictvím protokolu AMQP. V obou případech bude zpráva vypadat obvyklé v rámci příslušného protokolu. Vlastnosti zprostředkovatele jsou přeloženy podle potřeby a vlastnosti uživatele jsou mapovány na nejvhodnější umístění na model zprávy příslušného protokolu. V protokolu HTTP mapovat vlastnosti uživatele přímo do a z hlavičky protokolu HTTP; v protokolu AMQP mapují do a z **vlastnosti aplikace** mapy.

## <a name="message-routing-and-correlation"></a>Směrování zpráv a korelace

Podmnožinu vlastností Service broker je popsáno dříve, konkrétně [k](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [ ID korelace](/dotnet/api/microsoft.azure.servicebus.message.correlationid), a [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid), pomáhají aplikace směrování zpráv do konkrétního umístění. Pro znázornění, vezměte v úvahu několik vzorových postupů:

- **Jednoduchý požadavek/odpověď**: vydavatel odešle zprávu do fronty a očekává, že odpověď od příjemce zprávy. Vydavatele a obdržet odpověď, vlastní fronty, do kterého se očekává, že odpovědi doručit. Adresa této fronty je vyjádřen v **ReplyTo** vlastnost odchozí zprávy. Pokud takový příjemce odpoví, zkopíruje **MessageId** zpracované zprávy do **CorrelationId** vlastnost zprávy s odpovědí a zajišťuje zprávy do cíle indikován **ReplyTo** vlastnost. Jedna zpráva může přinést více odpovědí, v závislosti na kontextu aplikace.
- **Vícesměrového vysílání požadavku/odpovědi**: jako varianta předchozí vzor, vydavatel, odešle zprávu do tématu a několik předplatitelů nárok využívat zprávy. Každý odběratelů může odpovídat způsobem je popsáno výše. Tento model se používá ve scénářích zjišťování nebo vrácení volání a respondent obvykle identifikuje s vlastností uživatele nebo v datové části. Pokud **ReplyTo** body do tématu, sada zjišťování odpovědí lze distribuovat posílat cílové skupině.
- **Multiplexing**: Tato funkce relace umožňuje multiplexing streamů související zprávy prostřednictvím jedné frontě nebo odběru, tak, aby každá relace (nebo skupiny) související zprávy, identifikovat to provede spárováním odpovídajících **SessionId**hodnot, jsou směrovány do konkrétního příjemce příjemce drží relaci v rámci uzamčení. Další informace o podrobnosti relace [tady](message-sessions.md).
- **Multiplexní požadavku/odpovědi**: Tato funkce relace umožňuje multiplexované odpovědi, sdílet frontu odpovědí několik vydavatelům umožnili. Nastavením **ReplyToSessionId**, vydavatele můžete dát pokyn consumer(s) zkopírujte tuto hodnotu do **SessionId** vlastnost zprávy s odpovědí. Publikování fronty nebo tématu nemusí být s ohledem na relaci. Jak je zpráva odeslána, vydavatele můžete konkrétně počkejte relaci s daný **SessionId** cílem materializovat podmíněně přijetím příjemce relace ve frontě. 

Směrování v rámci oboru názvů služby Service Bus se dají realizovat pomocí řetězení auto-forward a pravidel odběru tématu. Směrování mezi obory názvů se dají realizovat [pomocí Azure LogicApps](https://azure.microsoft.com/services/logic-apps/). Jak je uvedeno v předchozím seznamu, **k** vlastnost je vyhrazen pro budoucí použití a může být interpretován nakonec zprostředkovatelem pomocí speciálně povolená funkce. Aplikace, které chcete implementovat směrování by měl postupujte proto podle vlastnosti uživatele a ne na další **k** vlastnost; však nebude nyní mohlo způsobit problémy s kompatibilitou.

## <a name="payload-serialization"></a>Datová část serializace

Při přenosu nebo uložené v rámci služby Service Bus, datové části je vždy neprůhledný, binární bloku. [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) vlastnost umožňuje aplikacím k popisu na datovou část s doporučený formát pro hodnoty vlastností se popis typ obsahu MIME podle IETF RFC2045; například `application/json;charset=utf-8`.

Na rozdíl od varianty Java nebo .NET Standard, .NET Framework verze rozhraní API služby Service Bus podporuje vytváření **BrokeredMessage** instance předáním libovolného objektů .NET do konstruktoru. 

Pokud používáte starší verzi protokolu SBMP, tyto objekty jsou pak serializován výchozí binární serializační procedury, nebo s serializátoru, který je poskytnut externě. Při použití protokolu AMQP, je objekt serializován do objektu AMQP. Příjemce může načíst tyto objekty se [GetBody<T>()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) metodu očekávaného typu. Pomocí protokolu AMQP, objekty serializují do AMQP graf **ArrayList** a **IDictionary < string, object >** objekty a libovolného klienta protokolu AMQP dekódování je. 

Zatímco tato magic skryté serializace je vhodné, aplikace by měl explicitní postará o serializaci objektů a jejich grafů objektů do datových proudů před zahrnutím do zprávy a opačný na straně příjemce. To dává interoperabilní výsledky. Je také potřeba poznamenat, že během AMQP má výkonný model binární kódování, je spojený s ekosystémem zasílání zpráv protokolu AMQP a HTTP klienti budou mít potíže při dekódování takové datové části. 

Obecně doporučujeme JSON a Apache Avro jako datových formátů pro strukturovaná data.

Varianty rozhraní API Java a .NET Standard přijímat pouze pole bajtů, což znamená, že aplikace musí zpracovat řízení serializace objektu. 

## <a name="next-steps"></a>Další postup

Další informace o zasílání zpráv Service Bus, najdete v následujících tématech:

* [Základy služby Service Bus](service-bus-fundamentals-hybrid-solutions.md)
* [Fronty, témata a odběry služby Service Bus](service-bus-queues-topics-subscriptions.md)
* [Začínáme s frontami služby Service Bus](service-bus-dotnet-get-started-with-queues.md)
* [Jak používat témata a odběry Service Bus](service-bus-dotnet-how-to-use-topics-subscriptions.md)
